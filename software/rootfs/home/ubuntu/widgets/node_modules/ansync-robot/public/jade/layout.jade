!!! 5
html
  head
    title= title
    meta(http-equiv='Content-type', content='text/html; charset=UTF-8')
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0')
    style
      body {
      overflow        : hidden;
      padding         : 0;
      margin          : 0;
      background-color: #BBB;
      //position:relative;
      }
      #info {
      position        : absolute;
      top             : 0px;
      width           : 100%;
      padding         : 5px;
      text-align      : center;
      }
      #info a {
      color           : #66F;
      text-decoration : none;
      }
      #info a:hover {
      text-decoration : underline;
      }
      #container1 {
      width           : 50%;
      height          : 100%;
      overflow        : hidden;
      padding         : 0;
      margin          : 0;
      float:left;
      -webkit-user-select     : none;
      -moz-user-select        : none;
      }
      #container2 {
      width           : 50%;
      height          : 100%;
      overflow        : hidden;
      padding         : 0;
      margin          : 0;
      -webkit-user-select     : none;
      -moz-user-select        : none;
      }
    link(rel='stylesheet', href='css/style.css')
    link(rel='stylesheet', href='css/jquery-ui-1.8.23.custom.css')
    script(type='text/javascript', src='js/jquery-1.8.0.min.js')
    script(type='text/javascript', src='js/jquery-ui-1.8.23.custom.min.js')
    script(type='text/javascript', src='/socket.io/socket.io.js')
    script(type='text/javascript', src='js/robot.js')
  body
    img#webcam(src='img/webcamframe.png', style='align:middle;z-index:-1;position:absolute;top:0;left:0')
    //#site_wrapper
    #container1
    #container2
    #info
      | Touch the screen and move
      br
      img(src='img/logo_blue.png', style='align:left;float:left;width:165px,height:165px', width='165px', height='165px');
      img(src='img/battery-80.png', style='align:right;float:right;width:85px,height:64px', width='85px', height='64px');
      img#audio(src='img/speaker.png', style='align:right;float:right;width:64px,height:64px', width='64px', height='64px');
      img#wifi(src='img/network-offline.png', style='align:right;float:right;width:64px,height:64px', width='64px', height='64px');
      span#result
    script(src='js/virtualjoystick.js/virtualjoystick.js')
    script
      var socket=io.connect('http://' + window.location.hostname + ':2000');
      console.log("touchscreen is", VirtualJoystick.touchScreenAvailable() ? "available" : "not available");
      var joystick1   = new VirtualJoystick({
      container       : document.getElementById('container1'),
      mouseSupport    : true
      });
      var joystick2   = new VirtualJoystick({
      container       : document.getElementById('container2'),
      mouseSupport    : true
      });
      setInterval(function(){
      window.joystick1 = joystick1;
      window.joystick2 = joystick2;
      var outputEl    = document.getElementById('result');
      outputEl.innerHTML      = '<b>Result:</b> '
      + (joystick1.deltaX() != 0? ' dx:'+joystick1.deltaX(): '')
      + (joystick1.deltaY() != 0? ' dy:'+joystick1.deltaY(): '')
      + (joystick1.right()    ? ' right'      : '')
      + (joystick1.up()       ? ' up'         : '')
      + (joystick1.left()     ? ' left'       : '')
      + (joystick1.down()     ? ' down'       : '')
      + (joystick2.deltaX() > 0? ' rotate clockwise:'+joystick2.deltaX(): '')
      + (joystick2.deltaX() < 0? ' rotate counterclockwise:'+Math.abs(joystick2.deltaX()): '');
      }, 1/30 * 1000);
      socket.on('wifi', function(data) {
        if (isNaN(data.signal)) {
          $('#wifi').attr('src', 'img/network-offline.png');
        } else {
          if (data.signal <= 100 && data.signal >= 76) {
            $('#wifi').attr('src', 'img/wifi-100.png');
          } else if (data.signal <= 75 && data.signal >= 51) {
            $('#wifi').attr('src', 'img/wifi-75.png');
          } else if (data.signal <= 50 && data.signal >= 26) {
            $('#wifi').attr('src', 'img/wifi-50.png');
          } else if (data.signal <= 25 && data.signal >= 1) {
            $('#wifi').attr('src', 'img/wifi-25.png');
          } else {
            $('#wifi').attr('src', 'img/wifi-00.png');
          }
        }
      });
      $('#audio').click(function() {
        socket.emit("sound");
      });
