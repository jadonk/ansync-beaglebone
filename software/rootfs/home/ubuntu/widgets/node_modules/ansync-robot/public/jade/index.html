<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		
		<style>
		body {
			overflow	: hidden;
			padding		: 0;
			margin		: 0;
			background-color: #BBB;
			position:relative;
		}
		#webcam, #site_wrapper {
			position:absolute;
			top: 0;
			left: 0;
			right: 0;
		}
		#info {
			position	: absolute;
			top		: 0px;
			width		: 100%;
			padding		: 5px;
			text-align	: center;
		}
		#info a {
			color		: #66F;
			text-decoration	: none;
		}
		#info a:hover {
			text-decoration	: underline;
		}
		#container1 {
			width		: 50%;
			height		: 100%;
			overflow	: hidden;
			padding		: 0;
			margin		: 0;
			float:left;
			-webkit-user-select	: none;
			-moz-user-select	: none;
		}
		#container2 {
			width		: 50%;
			height		: 100%;
			overflow	: hidden;
			padding		: 0;
			margin		: 0;
			-webkit-user-select	: none;
			-moz-user-select	: none;
		}
		</style>
	</head>
	<body>
		<embed id="webcam">
		<div id="site_wrapper">
			<div id="container1"></div>
			<div id="container2"></div>
			<div id="info">
				Touch the screen and move
				<br/>
				<span id="result"></span>
			</div> 
		</div>
		<script src="virtualjoystick.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script>
			console.log("touchscreen is", VirtualJoystick.touchScreenAvailable() ? "available" : "not available");
			var socket = io.connect('http://localhost');
			var joystick1	= new VirtualJoystick({
				container	: document.getElementById('container1'),
				mouseSupport	: true
			});
			var joystick2	= new VirtualJoystick({
				container	: document.getElementById('container2'),
				mouseSupport	: true
			});
			setInterval(function(){
				window.joystick1 = joystick1;
				window.joystick2 = joystick2;
				var outputEl	= document.getElementById('result');
				outputEl.innerHTML	= '<b>Result:</b> '
					+ (joystick1.deltaX() != 0? ' dx:'+joystick1.deltaX(): '')
					+ (joystick1.deltaY() != 0? ' dy:'+joystick1.deltaY(): '')
					+ (joystick1.right()	? ' right'	: '')
					+ (joystick1.up()	? ' up'		: '')
					+ (joystick1.left()	? ' left'	: '')
					+ (joystick1.down()	? ' down' 	: '')
					+ (joystick2.deltaX() > 0? ' rotate clockwise:'+joystick2.deltaX(): '')
					+ (joystick2.deltaX() < 0? ' rotate counterclockwise:'+Math.abs(joystick2.deltaX()): '');

			}, 1/30 * 1000);
			socket.on('wifi', function(data) {
				console.log("signal: " + data);
			});
		</script>
	</body>
</html>
