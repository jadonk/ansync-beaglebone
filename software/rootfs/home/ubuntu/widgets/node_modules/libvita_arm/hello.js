var argv = require('optimist')
    .describe('group', 'Group to address')
    .default('group', 1)
    .alias('g', 'group')
    .describe('channel', 'Channel to address')
    .default('channel', 0)
    .alias('c', 'channel')
    .describe('output', 'Set outputs. (0) sink (1) do not.')
    .alias('o', 'output')
    .describe('device', 'Select device type.')
    .default('device', 'an2006')
    .alias('d', 'device')
    .argv;

var addon = require('./index');
var vita = addon.open(argv.device);

if ("output" in argv) {
	console.log("setOutputs");
	//vita.setProperty(argv.group, argv.channel, 1, 0, function(err) {
		vita.setOutputs(argv.group, argv.channel, argv.output, function(err) {
	//	console.log("\terr = " + err);
	//        console.log("\t" + (err || 'Outputs set to 0x%s'), argv.output.toString(16));
		if (err) {
			console.log("\tError: " + err);
		} else {
			console.log('\tOutputs set to 0x%s', argv.output.toString(16));
		}
		 });
	//});
}

//vita.startAgent(argv.group, argv.channel, 100, function(err, data) {
	 //console.log('agent');
	 //if (err) console.log("\t" +err);
	 //else console.log("\t" +data.toString(16) + "  " + data.toString(10));
//});

//vita.startAgent(2, 1, 1, function(err, data) {
	 //console.log('agent');
	 //if (err) console.log("\t" +err);
	 //else console.log("\t" +data.toString(16) + "  " + data.toString(10));
//});

//vita.getInputs(2, 1, function(err, data) {
	 //console.log('getInputs');
	 //if (err) console.log("\t" +err);
	 //else console.log("\t" +data.toString(16) + "  " + data.toString(10));
	 //vita.close();
//});

//vita.getInputs(argv.group, argv.channel, function(err, data) {
	 //console.log('getInputs');
	 //if (err) console.log("\t" +err);
	 //else console.log("\t" +data.toString(16) + "  " + data.toString(10));
	 //vita.close();
//});

//vita.requestProperty(0, 0, 1, function(err, data) {
	 //console.log('getInputs');
	 //if (err) console.log("\t" + err);
	 //else console.log("\t" +data.toString(16) + "  " + data.toString(10));
	 //vita.close();
//});

setTimeout(function(){},1000);
